//Fuel Sale Summary and Cash Register Script

const tableOrdinaire = {
0.5:31,
1:48,
1.5:67,
2:89,
2.5:112,
3:137,
3.5:164,
4:193,
4.5:223,
5:254,
5.5:287,
6:322,
6.5:357,
7:394,
7.5:432,
8:471,
8.5:511,
9:553,
9.5:596,
10:639,
10.5:684,
11:730,
11.5:776,
12:824,
12.5:873,
13:922,
13.5:973,
14:1024,
14.5:1077,
15:1130,
15.5:1184,
16:1239,
16.5:1295,
17:1351,
17.5:1409,
18:1467,
18.5:1526,
19:1586,
19.5:1646,
20:1708,
20.5:1770,
21:1832,
21.5:1896,
22:1960,
22.5:2025,
23:2091,
23.5:2157,
24:2224,
24.5:2292,
25:2360,
25.5:2429,
26:2499,
26.5:2569,
27:2640,
27.5:2712,
28:2784,
28.5:2857,
29:2030,
29.5:3004,
30:3079,
30.5:3154,
31:3230,
31.5:3306,
32:3383,
32.5:3460,
33:3539,
33.5:3617,
34:3696,
34.5:3776,
35:3858,
35.5:3937,
36:4018,
36.5:4100,
37:4183,
37.5:4265,
38:4349,
38.5:4433,
39:4517,
39.5:4602,
40:4687,
40.5:4773,
41:4859,
41.5:4946,
42:5034,
42.5:5121,
43:5209,
43.5:5298,
44:5387,
44.5:5477,
45:5567,
45.5:5657,
46:5748,
46.5:5839,
47:5931,
47.5:6023,
48:6116,
48.5:6208,
49:6302,
49.5:6396,
50:6490,
50.5:6584,
51:6679,
51.5:6775,
52:6870,
52.5:6967,
53:7063,
53.5:7160,
54:7257,
54.5:7355,
55:7453,
55.5:7551,
56:7650,
56.5:7749,
57:7849,
57.5:7948,
58:8048,
58.5:8149,
59:8250,
59.5:8351,
60:8452,
60.5:8554,
61:8656,
61.5:8759,
62:8862,
62.5:8965,
63:9068,
63.5:9172,
64:9276,
64.5:9380,
65:9485,
65.5:9590,
66:9695,
66.5:9800,
67:9906,
67.5:10012,
68:10119,
68.5:10225,
69:10332,
69.5:10439,
70:10547,
70.5:10654,
71:10762,
71.5:10871,
72:10979,
72.5:11088,
73:11197,
73.5:11306,
74:11416,
74.5:11525,
75:11635,
75.5:11746,
76:11856,
76.5:11967,
77:12078,
77.5:12189,
78:12300,
78.5:12412,
79:12524,
79.5:12636,
80:12748,
80.5:12860,
81:12973,
81.5:13086,
82:13190,
82.5:13312,
83:13426,
83.5:13540,
84:13653,
84.5:13767,
85:13882,
85.5:13996,
86:14111,
86.5:14225,
87:14340,
87.5:14456,
88:14571,
88.5:14686,
89:14802,
89.5:14918,
90:15034,
90.5:15150,
91:15266,
91.5:15383,
92:15499,
92.5:15616,
93:15733,
93.5:15850,
94:15967,
94.5:16084,
95:16202,
95.5:16319,
96:16437,
96.5:16555,
97:16673,
97.5:16791,
98:16909,
98.5:17027,
99:17146,
99.5:17264,
100:17383,
100.5:17501,
101:17620,
101.5:17739,
102:17858,
102.5:17977,
103:18097,
103.5:18216,
104:18336,
104.5:18455,
105:18575,
105.5:18694,
106:18814,
106.5:18934,
107:19054,
107.5:19174,
108:19294,
108.5:19414,
109:19534,
109.5:19655,
110:19775,
110.5:19895,
111:20016,
111.5:20136,
112:20257,
112.5:20377,
113:20498,
113.5:20619,
114:20740,
114.5:20860,
115:20981,
115.5:21102,
116:21223,
116.5:21344,
117:21465,
117.5:21586,
118:21707,
118.5:21828,
119:21949,
119.5:22070,
120:22191,
120.5:22312,
121:22433,
121.5:22554,
122:22675,
122.5:22796,
123:22917,
123.5:23038,
124:23160,
124.5:23281,
125:23402,
125.5:23523,
126:23644,
126.5:23765,
127:23886,
127.5:24007,
128:24128,
128.5:24249,
129:24370,
129.5:24491,
130:24611,
130.5:24732,
131:24853,
131.5:24974,
132:25094,
132.5:25215,
133:25336,
133.5:25456,
134:25577,
134.5:25697,
135:25817,
135.5:25938,
136:26058,
136.5:26178,
137:26298,
137.5:26418,
138:26538,
138.5:26658,
139:26778,
139.5:26898,
140:27017,
140.5:27137,
141:27256,
141.5:27376,
142:27495,
142.5:27614,
143:27733,
143.5:27852,
144:27971,
144.5:28090,
145:28209,
145.5:28327,
146:28446,
146.5:28564,
147:28683,
147.5:28801,
148:28919,
148.5:29037,
149:29154,
149.5:29272,
150:29390,
150.5:29507,
151:29624,
151.5:29741,
152:29858,
152.5:29975,
153:30092,
153.5:30208,
154:30325,
154.5:30441,
155:30557,
155.5:30673,
156:30788,
156.5:30904,
157:31019,
157.5:31135,
158:31250,
158.5:31365,
159:31479,
159.5:31594,
160:31708,
160.5:31822,
161:31936,
161.5:32050,
162:32164,
162.5:32277,
163:32390,
163.5:32503,
164:32616,
164.5:32729,
165:32841,
165.5:32953,
166:33065,
166.5:33177,
167:33288,
167.5:33400,
168:33511,
168.5:33622,
169:33732,
169.5:33843,
170:33953,
170.5:34063,
171:34172,
171.5:34282,
172:34391,
172.5:34500,
173:34608,
173.5:34717,
174:34825,
174.5:34933,
175:35040,
175.5:35140,
176:35255,
176.5:35362,
177:35468,
177.5:35574,
178:35680,
178.5:35786,
179:35891,
179.5:35997,
180:36101,
180.5:36206,
181:36310,
181.5:36414,
182:36518,
182.5:36621,
183:36724,
183.5:36826,
184:36929,
184.5:37031,
185:37132,
185.5:37234,
186:37335,
186.5:37435,
187:37536,
187.5:37636,
188:37735,
188.5:37835,
189:37934,
189.5:38032,
190:38130,
190.5:38228,
191:38326,
191.5:38423,
192:38520,
192.5:38616,
193:38712,
193.5:38808,
194:38903,
194.5:38998,
195:39092,
195.5:39186,
196:39280,
196.5:39373,
197:39466,
197.5:39558,
198:39650,
198.5:39742,
199:39833,
199.5:39923,
200:40014,
200.5:40103,
201:40193,
201.5:40282,
202:40370,
202.5:40458,
203:40546,
203.5:40633,
204:40719,
204.5:40805,
205:40891,
205.5:40976,
206:41061,
206.5:41145,
207:41229,
207.5:41312,
208:41394,
208.5:41477,
209:41558,
209.5:41639,
210:41720,
210.5:41800,
211:41879,
211.5:41958,
212:42037,
212.5:42115,
213:42192,
213.5:42269,
214:42345,
214.5:42420,
215:42495,
215.5:42570,
216:42644,
216.5:42717,
217:42789,
217.5:42861,
218:42933,
218.5:43003,
219:43073,
219.5:43143,
220:43241,
220.5:43280,
221:43347,
221.5:43414,
222:43480,
222.5:43545,
223:43610,
223.5:43674,
224:43737,
224.5:43799,
225:43861,
225.5:43922,
226:43982,
226.5:44042,
227:44101,
227.5:44158,
228:44216,
228.5:44272,
229:44327,
229.5:44382,
230:44436,
230.5:44489,
231:44540,
231.5:44592,
232:44642,
232.5:44691,
233:44739,
233.5:44787,
234:44833,
234.5:44878,
235:44923,
235.5:44966,
236:45008,
236.5:45049,
237:45089,
237.5:45128,
238:45165,
238.5:45201,
239:45236,
239.5:45270,
240:45303,
240.5:45333,
241:45363,
241.5:45391,
242:45417,
242.5:45441,
243:45464,
243.5:45485,
244:45503,
244.5:45519,
245:45532
};

const tableSuperDiesel = {
0.5:16,
1:25,
1.5:35,
2:46,
2.5:57,
3:70,
3.5:84,
4:98,
4.5:113,
5:129,
5.5:145,
6:162,
6.5:179,
7:198,
7.5:216,
8:235,
8.5:255,
9:275,
9.5:296,
10:317,
10.5:339,
11:361,
11.5:384,
12:407,
12.5:431,
13:454,
13.5:479,
14:503,
14.5:528,
15:554,
15.5:580,
16:606,
16.5:633,
17:659,
17.5:687,
18:714,
18.5:742,
19:771,
19.5:799,
20:828,
20.5:857,
21:887,
21.5:917,
22:947,
22.5:977,
23:1008,
23.5:1039,
24:1071,
24.5:1102,
25:1134,
25.5:1166,
26:1199,
26.5:1231,
27:1264,
27.5:1298,
28:1331,
28.5:1365,
29:1399,
29.5:1433,
30:1467,
30.5:1502,
31:1537,
31.5:1572,
32:1608,
32.5:1643,
33:1679,
33.5:1715,
34:1751,
34.5:1788,
35:1825,
35.5:1862,
36:1899,
36.5:1936,
37:1974,
37.5:2012,
38:2050,
38.5:2088,
39:2126,
39.5:2165,
40:2203,
40.5:2242,
41:2282,
41.5:2321,
42:2360,
42.5:2400,
43:2440,
43.5:2480,
44:2520,
44.5:2561,
45:2601,
45.5:2642,
46:2683,
46.5:2724,
47:2765,
47.5:2807,
48:2848,
48.5:2890,
49:2932,
49.5:2974,
50:3016,
50.5:3058,
51:3101,
51.5:3144,
52:3186,
52.5:3229,
53:3273,
53.5:3316,
54:3359,
54.5:3403,
55:3446,
55.5:3490,
56:3534,
56.5:3578,
57:3623,
57.5:3667,
58:3711,
58.5:3756,
59:3801,
59.5:3846,
60:3891,
60.5:3936,
61:3981,
61.5:4026,
62:4072,
62.5:4117,
63:4163,
63.5:4209,
64:4255,
64.5:4301,
65:4347,
65.5:4394,
66:4440,
66.5:4486,
67:4533,
67.5:4580,
68:4627,
68.5:4674,
69:4721,
69.5:4768,
70:4815,
70.5:4862,
71:4910,
71.5:4957,
72:5005,
72.5:5053,
73:5101,
73.5:5149,
74:5197,
74.5:5245,
75:5293,
75.5:5341,
76:5389,
76.5:5438,
77:5486,
77.5:5535,
78:5584,
78.5:5633,
79:5681,
79.5:5730,
80:5779,
80.5:5829,
81:5878,
81.5:5927,
82:5976,
82.5:6026,
83:6075,
83.5:6125,
84:6174,
84.5:6224,
85:6274,
85.5:6324,
86:6374,
86.5:6424,
87:6474,
87.5:6524,
88:6574,
88.5:6624,
89:6674,
89.5:6725,
90:6775,
90.5:6825,
91:6876,
91.5:6927,
92:6977,
92.5:7028,
93:7079,
93.5:7129,
94:7180,
94.5:7231,
95:7282,
95.5:7333,
96:7384,
96.5:7435,
97:7486,
97.5:7537,
98:7589,
98.5:7640,
99:7691,
99.5:7742,
100:7794,
100.5:7845,
101:7897,
101.5:7948,
102:8000,
102.5:8051,
103:8103,
103.5:8154,
104:8206,
104.5:8258,
105:8309,
105.5:8361,
106:8413,
106.5:8465,
107:8517,
107.5:8569,
108:8620,
108.5:8672,
109:8724,
109.5:8776,
110:8828,
110.5:8880,
111:8932,
111.5:8984,
112:9036,
112.5:9088,
113:9141,
113.5:9193,
114:9245,
114.5:9297,
115:9349,
115.5:9401,
116:9453,
116.5:9506,
117:9558,
117.5:9610,
118:9662,
118.5:9715,
119:9767,
119.5:9819,
120:9871,
120.5:9924,
121:9976,
121.5:10028,
122:10080,
122.5:10133,
123:10185,
123.5:10237,
124:10289,
124.5:10342,
125:10394,
125.5:10446,
126:10498,
126.5:10551,
127:10603,
127.5:10655,
128:10707,
128.5:10759,
129:10812,
129.5:10864,
130:10916,
130.5:10968,
131:11020,
131.5:11072,
132:11125,
132.5:11177,
133:11229,
133.5:11281,
134:11333,
134.5:11385,
135:11437,
135.5:11489,
136:11541,
136.5:11593,
137:11645,
137.5:11696,
138:11748,
138.5:11800,
139:11852,
139.5:11904,
140:11955,
140.5:12007,
141:12059,
141.5:12110,
142:12162,
142.5:12214,
143:12265,
143.5:12317,
144:12368,
144.5:12420,
145:12471,
145.5:12522,
146:12574,
146.5:12625,
147:12676,
147.5:12727,
148:12779,
148.5:12830,
149:12881,
149.5:12932,
150:12983,
150.5:13034,
151:13084,
151.5:13135,
152:13186,
152.5:13237,
153:13287,
153.5:13338,
154:13388,
154.5:13439,
155:13489,
155.5:13540,
156:13590,
156.5:13640,
157:13690,
157.5:13741,
158:13791,
158.5:13841,
159:13891,
159.5:13940,
160:13990,
160.5:14040,
161:14090,
161.5:14139,
162:14189,
162.5:14238,
163:14288,
163.5:14337,
164:14386,
164.5:14435,
165:14484,
165.5:14533,
166:14582,
166.5:14631,
167:14680,
167.5:14729,
168:14777,
168.5:14826,
169:14874,
169.5:14922,
170:14971,
170.5:15019,
171:15067,
171.5:15115,
172:15163,
172.5:15211,
173:15258,
173.5:15306,
174:15353,
174.5:15401,
175:15448,
175.5:15495,
176:15542,
176.5:15589,
177:15636,
177.5:15683,
178:15730,
178.5:15776,
179:15823,
179.5:15869,
180:15915,
180.5:15962,
181:16008,
181.5:16054,
182:16099,
182.5:16145,
183:16191,
183.5:16236,
184:16281,
184.5:16327,
185:16372,
185.5:16417,
186:16461,
186.5:16506,
187:16551,
187.5:16595,
188:16639,
188.5:16684,
189:16728,
189.5:16772,
190:16815,
190.5:16859,
191:16902,
191.5:16946,
192:16989,
192.5:17032,
193:17075,
193.5:17118,
194:17160,
194.5:17203,
195:17245,
195.5:17287,
196:17329,
196.5:17371,
197:17413,
197.5:17454,
198:17496,
198.5:17537,
199:17578,
199.5:17619,
200:17659,
200.5:17700,
201:17740,
201.5:17780,
202:17820,
202.5:17860,
203:17900,
203.5:17939,
204:17978,
204.5:18017,
205:18056,
205.5:18095,
206:18133,
206.5:18172,
207:18210,
207.5:18248,
208:18285,
208.5:18323,
209:18360,
209.5:18397,
210:18434,
210.5:18471,
211:18507,
211.5:18544,
212:18580,
212.5:18615,
213:18651,
213.5:18686,
214:18721,
214.5:18755,
215:18791,
215.5:18825,
216:18859,
216.5:18893,
217:18927,
217.5:18960,
218:18993,
218.5:19026,
219:19059,
219.5:19091,
220:19123,
220.5:19155,
221:19186,
221.5:19217,
222:19248,
222.5:19279,
223:19309,
223.5:19339,
224:19369,
224.5:19399,
225:19428,
225.5:19456,
226:19485,
226.5:19513,
227:19541,
227.5:19568,
228:19596,
228.5:19622,
229:19649,
229.5:19675,
230:19701,
230.5:19726,
231:19751,
231.5:19775,
232:19799,
232.5:19823,
233:19846,
233.5:19869,
234:19892,
234.5:19914,
235:19935,
235.5:19956,
236:19977,
236.5:19997,
237:20017,
237.5:20036,
238:20054,
238.5:20072,
239:20089,
239.5:20106,
240:20122,
240.5:20137,
241:20152,
241.5:20166,
242:20179,
242.5:20192,
243:20203,
243.5:20214,
244:20223,
244.5:20231,
245:20238
};

const config = [
  { id: "sold-ordinaire", table: tableOrdinaire, input: "before-ordinaire", target: "after-ordinaire" },
  { id: "sold-extra", table: tableOrdinaire, input: "before-extra", target: "after-extra" },
  { id: "sold-supreme", table: tableSuperDiesel, input: "before-supreme", target: "after-supreme" },
  { id: "sold-diesel", table: tableSuperDiesel, input: "before-diesel", target: "after-diesel" },
];

function lookup(table, value) {
  value = Number(value);
  return table.hasOwnProperty(value) ? table[value] : undefined;
}

function updateAfter(table, targetLitres) {
  let closestKey = null;
  let closestDiff = Infinity;

  for (const cm in table) {
    const litres = table[cm];
    const diff = Math.abs(litres - targetLitres);

    if (diff < closestDiff) {
      closestDiff = diff;
      closestKey = cm;
    }
  }

  return closestKey;
}

config.forEach(({ id, table, input, target }) => {
  const sold = document.getElementById(id);
  const before = document.getElementById(input);
  const after = document.getElementById(target);

  if (sold && before) {
    sold.addEventListener("input", function() {
      if (id == "sold-ordinaire") {
        const soldextra = document.getElementById("sold-extra");
        after.value = before.value - updateAfter(table, ( sold.value / 2 ) + (soldextra.value / 2 ));
      }
      else if (id == "sold-extra") {
        const soldordinaire = document.getElementById("sold-ordinaire");
        after.value = before.value - updateAfter(table, ( sold.value / 2 ) + (soldordinaire.value / 2 ));
      }
      else {
        after.value = before.value - updateAfter(table, sold.value);
      }
    });
  }
});


// Canadian denominations and their values in dollars
const caisseDenominations = [
  { id: "caisse-100", value: 100 },
  { id: "caisse-50", value: 50 },
  { id: "caisse-20", value: 20 },
  { id: "caisse-10", value: 10 },
  { id: "caisse-5", value: 5 },
  { id: "caisse-2", value: 2 },
  { id: "caisse-1", value: 1 },
  { id: "caisse-025", value: 0.25 },
  { id: "caisse-010", value: 0.10 },
  { id: "caisse-005", value: 0.05 }
];

function updateDepot() {
  let total = -200;
  caisseDenominations.forEach(denom => {
const input = document.getElementById(denom.id);
const count = parseFloat(input.value) || 0;
total += count * denom.value;
  });

  const depotSpan = document.getElementById("caisse-depot");
  depotSpan.textContent = `$${total.toFixed(2)}`;
}

// Attach event listeners
window.addEventListener("DOMContentLoaded", () => {
  caisseDenominations.forEach(denom => {
const input = document.getElementById(denom.id);
if (input) {
  input.addEventListener("input", updateDepot);
}
  });
  updateDepot(); // Show initial value on page load
});